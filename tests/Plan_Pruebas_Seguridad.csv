ID,Categoría,Caso de Prueba,Método de Ataque,Resultado Esperado,Resultado Obtenido,Severidad,Estado,Tester,Fecha
ST-001,Autenticación,Acceso sin token,Request sin header Authorization,"Error 401 Unauthorized, Acceso denegado",,Alta,Pendiente,,
ST-002,Autenticación,Token expirado,Token con exp < now(),"Error 401, Mensaje: Token expirado",,Alta,Pendiente,,
ST-003,Autenticación,Token malformado,Header con string inválido,"Error 401, Sin crash de servidor",,Alta,Pendiente,,
ST-004,Autorización,Acceso con rol insuficiente,Mecánico intenta GET /api/admin/users,"Error 403 Forbidden, Sin datos expuestos",,Crítica,Pendiente,,
ST-005,Autorización,Modificar recurso de otro usuario,Usuario A intenta PATCH /api/users/{idB},"Error 403, Validación de ownership",,Crítica,Pendiente,,
ST-006,SQL Injection,Payload SQL en búsqueda,"GET /api/vehicles?search=' OR 1=1--","Sin ejecución SQL, Query escapada, Resultados vacíos o válidos",,Crítica,Pendiente,,
ST-007,XSS,Script en campo de texto,"POST /api/work-orders con description: '<script>alert(1)</script>'","HTML escapado, Script no ejecutable, Almacenado seguro",,Alta,Pendiente,,
ST-008,CSRF,Request sin token CSRF,"POST sin header X-CSRF-Token o verificación","Rechazado, Error 403 o validación fallida",,Media,Pendiente,,
ST-009,Passwords,Verificar hash bcrypt,Consultar BD y verificar campo password,"Nunca texto plano, Hash bcrypt válido, Salt único",,Crítica,Pendiente,,
ST-010,Session,Logout invalida token,POST /api/auth/logout → usar mismo token,"Token invalidado, Request falla con 401",,Alta,Pendiente,,
ST-011,Rate Limiting,100+ requests rápidas,Loop de 100 requests en < 60 segundos,"Después de límite: 429 Too Many Requests, IP bloqueada temporalmente",,Media,Pendiente,,
ST-012,File Upload,Subir archivo ejecutable,"POST /api/uploads con archivo .exe o .sh","Archivo rechazado, Error 400, Validación de MIME type",,Alta,Pendiente,,
ST-013,Audit,Acción administrativa,POST /api/users como Admin,"Log creado en audit_logs con: action, userId, resource, timestamp",,Media,Pendiente,,
ST-014,HTTPS,Acceso HTTP,http://app.pepsico.cl,"Redirect 301 a https://, Conexión no permitida en producción",,Alta,Pendiente,,
ST-015,Headers,Security headers presentes,Verificar response headers,"Headers: X-Content-Type-Options, X-Frame-Options, CSP, HSTS",,Media,Pendiente,,
ST-016,Path Traversal,Acceso a archivos del sistema,"GET /api/uploads/../../etc/passwd","Bloqueado, Path normalizado, Error 404 o 403",,Crítica,Pendiente,,
ST-017,Mass Assignment,Campos no permitidos en update,"PATCH /api/users/:id con { isAdmin: true }","Campo ignorado, Solo campos whitelisteados actualizados",,Alta,Pendiente,,
ST-018,NoSQL Injection,Payload en filtros,"GET /api/users?role[$ne]=admin","Query parametrizada, Payload escapado, Sin exposición",,Alta,Pendiente,,
ST-019,Information Disclosure,Error con stack trace en producción,Request que genera error 500,"Mensaje genérico, Sin stack trace, Log en servidor",,Media,Pendiente,,
ST-020,Brute Force,Intentos de login masivos,50 intentos de login fallidos en 5 min,"Cuenta bloqueada temporalmente, Captcha requerido, Alerta generada",,Alta,Pendiente,,
ST-021,Session Fixation,Usar session ID pre-generado,Intentar fijar sessionId conocido,"Session regenerada en login, ID antiguo invalidado",,Media,Pendiente,,
ST-022,Insecure Direct Object Reference,Acceder recurso con ID ajeno,GET /api/work-orders/123 (no pertenece al usuario),"Validación de ownership, Error 403 o 404",,Alta,Pendiente,,
ST-023,Sensitive Data Exposure,Passwords en responses,GET /api/users/:id,"Campo password excluido, Solo datos públicos expuestos",,Crítica,Pendiente,,
ST-024,JWT Secret,Verificar fortaleza del secret,Inspeccionar configuración,"Secret >= 256 bits, Almacenado en env variable, Nunca en código",,Crítica,Pendiente,,
ST-025,Dependency Vulnerabilities,npm audit,Ejecutar npm audit en proyecto,"Cero vulnerabilidades críticas o altas, Dependencias actualizadas",,Alta,Pendiente,,
